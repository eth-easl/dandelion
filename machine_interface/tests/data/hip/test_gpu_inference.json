{
    "modules": [ { "module_name": "mlops.hsaco", "path": "mlops.hsaco" }, { "module_name": "module.hsaco", "path": "module.hsaco" } ],
    "kernels": [
        { "module_name": "mlops.hsaco", "kernel_name": "matmul_f" },
        { "module_name": "mlops.hsaco", "kernel_name": "convolution_f" },
        { "module_name": "mlops.hsaco", "kernel_name": "relu_2d_f" },
        { "module_name": "mlops.hsaco", "kernel_name": "maxpool_f" },
        { "module_name": "module.hsaco", "kernel_name": "hello_world" }
    ],
    "blueprint": {
        "inputs": ["cfg", "A", "B"],
        "buffers": {"C": {"Sizeof": "A"}, "D": {"FromInput": {"bufname": "cfg", "idx": 0}}},
        "outputs": ["D"],
        "control_flow": [
            {"Repeat": [{"FromInput": {"bufname": "cfg", "idx": 3}}, [
                {"ExecKernel": ["hello_world", [], {
                    "grid_dim_x": {"Absolute": 1}, 
                    "grid_dim_y": {"Absolute": 1}, 
                    "grid_dim_z": {"Absolute": 1},
                    "block_dim_x": {"Absolute": 1}, 
                    "block_dim_y": {"Absolute": 1}, 
                    "block_dim_z": {"Absolute": 1},
                    "shared_mem_bytes": {"Absolute": 0}
                }]},
                {"ExecKernel": ["convolution_f", [{"Ptr": "C"}, {"Ptr": "A"}, {"Ptr": "B"}], {
                    "grid_dim_x": {"FromInput": {"bufname": "cfg", "idx": 1}}, 
                    "grid_dim_y": {"FromInput": {"bufname": "cfg", "idx": 1}}, 
                    "grid_dim_z": {"Absolute": 1},
                    "block_dim_x": {"Absolute": 32},
                    "block_dim_y": {"Absolute": 32},
                    "block_dim_z": {"Absolute": 1},
                    "shared_mem_bytes": {"Absolute": 0}
                }]},
                {"ExecKernel": ["relu_2d_f", [{"Ptr": "C"}], {
                    "grid_dim_x": {"FromInput": {"bufname": "cfg", "idx": 1}}, 
                    "grid_dim_y": {"FromInput": {"bufname": "cfg", "idx": 1}}, 
                    "grid_dim_z": {"Absolute": 1},
                    "block_dim_x": {"Absolute": 32},
                    "block_dim_y": {"Absolute": 32},
                    "block_dim_z": {"Absolute": 1},
                    "shared_mem_bytes": {"Absolute": 0}
                }]},
                {"ExecKernel": ["maxpool_f", [{"Ptr": "D"}, {"Ptr": "C"}, {"Constant": 2}], {
                    "grid_dim_x": {"FromInput": {"bufname": "cfg", "idx": 2}}, 
                    "grid_dim_y": {"FromInput": {"bufname": "cfg", "idx": 2}}, 
                    "grid_dim_z": {"Absolute": 1},
                    "block_dim_x": {"Absolute": 32},
                    "block_dim_y": {"Absolute": 32},
                    "block_dim_z": {"Absolute": 1},
                    "shared_mem_bytes": {"Absolute": 0}
                }]}]
            ]}
        ]
    } 
}